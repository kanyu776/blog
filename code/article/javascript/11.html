<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>javascript 实用代码片段 | 戡玉的个人博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="业精于勤荒于嬉，行成于思毁于随">
    
    <link rel="preload" href="/blog/assets/css/0.styles.cb6842fd.css" as="style"><link rel="preload" href="/blog/assets/js/app.000460b6.js" as="script"><link rel="preload" href="/blog/assets/js/2.d291a91f.js" as="script"><link rel="preload" href="/blog/assets/js/1.eb9a41bf.js" as="script"><link rel="preload" href="/blog/assets/js/36.c76dcab4.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.5458d4b5.js"><link rel="prefetch" href="/blog/assets/js/100.008b1e11.js"><link rel="prefetch" href="/blog/assets/js/101.11ac553a.js"><link rel="prefetch" href="/blog/assets/js/102.9c4ecb1a.js"><link rel="prefetch" href="/blog/assets/js/103.4d8d3f52.js"><link rel="prefetch" href="/blog/assets/js/104.0f8aba34.js"><link rel="prefetch" href="/blog/assets/js/105.3e37a72e.js"><link rel="prefetch" href="/blog/assets/js/106.04506ad8.js"><link rel="prefetch" href="/blog/assets/js/107.8d0bff97.js"><link rel="prefetch" href="/blog/assets/js/108.e665ee7e.js"><link rel="prefetch" href="/blog/assets/js/109.a3825838.js"><link rel="prefetch" href="/blog/assets/js/11.6dec87a5.js"><link rel="prefetch" href="/blog/assets/js/110.b96abcc2.js"><link rel="prefetch" href="/blog/assets/js/111.c58aa255.js"><link rel="prefetch" href="/blog/assets/js/112.e8be0755.js"><link rel="prefetch" href="/blog/assets/js/113.03895dfa.js"><link rel="prefetch" href="/blog/assets/js/114.9a30bb2a.js"><link rel="prefetch" href="/blog/assets/js/115.4cfeab92.js"><link rel="prefetch" href="/blog/assets/js/116.90952127.js"><link rel="prefetch" href="/blog/assets/js/117.52e6938e.js"><link rel="prefetch" href="/blog/assets/js/118.5fbcaa03.js"><link rel="prefetch" href="/blog/assets/js/119.8ead66c6.js"><link rel="prefetch" href="/blog/assets/js/12.4b0e6367.js"><link rel="prefetch" href="/blog/assets/js/120.995f0c9f.js"><link rel="prefetch" href="/blog/assets/js/121.24591e4e.js"><link rel="prefetch" href="/blog/assets/js/122.86dd3522.js"><link rel="prefetch" href="/blog/assets/js/123.f868c5f2.js"><link rel="prefetch" href="/blog/assets/js/124.afce8a00.js"><link rel="prefetch" href="/blog/assets/js/125.4d4eeb87.js"><link rel="prefetch" href="/blog/assets/js/13.b0de7978.js"><link rel="prefetch" href="/blog/assets/js/14.2286727c.js"><link rel="prefetch" href="/blog/assets/js/15.f8079179.js"><link rel="prefetch" href="/blog/assets/js/16.e8e68b8f.js"><link rel="prefetch" href="/blog/assets/js/17.7daa3dd4.js"><link rel="prefetch" href="/blog/assets/js/18.772333af.js"><link rel="prefetch" href="/blog/assets/js/19.3fa31704.js"><link rel="prefetch" href="/blog/assets/js/20.84e91d21.js"><link rel="prefetch" href="/blog/assets/js/21.fe5c292d.js"><link rel="prefetch" href="/blog/assets/js/22.3b253005.js"><link rel="prefetch" href="/blog/assets/js/23.78b1fd62.js"><link rel="prefetch" href="/blog/assets/js/24.983dc2bb.js"><link rel="prefetch" href="/blog/assets/js/25.6b3bee2a.js"><link rel="prefetch" href="/blog/assets/js/26.ea390eeb.js"><link rel="prefetch" href="/blog/assets/js/27.ac10f173.js"><link rel="prefetch" href="/blog/assets/js/28.b5d850e2.js"><link rel="prefetch" href="/blog/assets/js/29.fa63697a.js"><link rel="prefetch" href="/blog/assets/js/3.8276b9a5.js"><link rel="prefetch" href="/blog/assets/js/30.df28389e.js"><link rel="prefetch" href="/blog/assets/js/31.dc2fd63e.js"><link rel="prefetch" href="/blog/assets/js/32.94b55d15.js"><link rel="prefetch" href="/blog/assets/js/33.01e39262.js"><link rel="prefetch" href="/blog/assets/js/34.3ba4e724.js"><link rel="prefetch" href="/blog/assets/js/35.a1bf00ac.js"><link rel="prefetch" href="/blog/assets/js/37.4e6efb91.js"><link rel="prefetch" href="/blog/assets/js/38.3dafa69a.js"><link rel="prefetch" href="/blog/assets/js/39.7f8654dc.js"><link rel="prefetch" href="/blog/assets/js/4.3e09a12a.js"><link rel="prefetch" href="/blog/assets/js/40.8604ca4b.js"><link rel="prefetch" href="/blog/assets/js/41.0c917daf.js"><link rel="prefetch" href="/blog/assets/js/42.a82d2409.js"><link rel="prefetch" href="/blog/assets/js/43.97b124a7.js"><link rel="prefetch" href="/blog/assets/js/44.cfc76ead.js"><link rel="prefetch" href="/blog/assets/js/45.5d1e47f1.js"><link rel="prefetch" href="/blog/assets/js/46.b6403fdf.js"><link rel="prefetch" href="/blog/assets/js/47.9f279179.js"><link rel="prefetch" href="/blog/assets/js/48.abd704fd.js"><link rel="prefetch" href="/blog/assets/js/49.177b31fe.js"><link rel="prefetch" href="/blog/assets/js/5.1be809ca.js"><link rel="prefetch" href="/blog/assets/js/50.086f06b8.js"><link rel="prefetch" href="/blog/assets/js/51.43a278a3.js"><link rel="prefetch" href="/blog/assets/js/52.793a9d8b.js"><link rel="prefetch" href="/blog/assets/js/53.be2f51b9.js"><link rel="prefetch" href="/blog/assets/js/54.945ca6e9.js"><link rel="prefetch" href="/blog/assets/js/55.ad614aee.js"><link rel="prefetch" href="/blog/assets/js/56.f61f3f50.js"><link rel="prefetch" href="/blog/assets/js/57.8dd57a6e.js"><link rel="prefetch" href="/blog/assets/js/58.41c10940.js"><link rel="prefetch" href="/blog/assets/js/59.9a3d4609.js"><link rel="prefetch" href="/blog/assets/js/6.9cdb95d4.js"><link rel="prefetch" href="/blog/assets/js/60.7740125a.js"><link rel="prefetch" href="/blog/assets/js/61.2b392f10.js"><link rel="prefetch" href="/blog/assets/js/62.bf4ee67d.js"><link rel="prefetch" href="/blog/assets/js/63.dffd1843.js"><link rel="prefetch" href="/blog/assets/js/64.1428c597.js"><link rel="prefetch" href="/blog/assets/js/65.525da292.js"><link rel="prefetch" href="/blog/assets/js/66.ee2c53b4.js"><link rel="prefetch" href="/blog/assets/js/67.64f1aa1d.js"><link rel="prefetch" href="/blog/assets/js/68.52f6c249.js"><link rel="prefetch" href="/blog/assets/js/69.88152320.js"><link rel="prefetch" href="/blog/assets/js/7.fa2ecde9.js"><link rel="prefetch" href="/blog/assets/js/70.e6bb671c.js"><link rel="prefetch" href="/blog/assets/js/71.3b33d6b8.js"><link rel="prefetch" href="/blog/assets/js/72.46b2dea9.js"><link rel="prefetch" href="/blog/assets/js/73.475c676e.js"><link rel="prefetch" href="/blog/assets/js/74.c56a6344.js"><link rel="prefetch" href="/blog/assets/js/75.645ee1f7.js"><link rel="prefetch" href="/blog/assets/js/76.1fbce9a1.js"><link rel="prefetch" href="/blog/assets/js/77.bf5956e2.js"><link rel="prefetch" href="/blog/assets/js/78.84e91ea3.js"><link rel="prefetch" href="/blog/assets/js/79.dd037aa7.js"><link rel="prefetch" href="/blog/assets/js/80.509e2744.js"><link rel="prefetch" href="/blog/assets/js/81.fc60c5d3.js"><link rel="prefetch" href="/blog/assets/js/82.c54d1196.js"><link rel="prefetch" href="/blog/assets/js/83.db64d1b9.js"><link rel="prefetch" href="/blog/assets/js/84.462a3eb1.js"><link rel="prefetch" href="/blog/assets/js/85.ba729ae0.js"><link rel="prefetch" href="/blog/assets/js/86.e8fe84b0.js"><link rel="prefetch" href="/blog/assets/js/87.191c589d.js"><link rel="prefetch" href="/blog/assets/js/88.8fb3c118.js"><link rel="prefetch" href="/blog/assets/js/89.acd867e3.js"><link rel="prefetch" href="/blog/assets/js/90.12d51230.js"><link rel="prefetch" href="/blog/assets/js/91.fa918aac.js"><link rel="prefetch" href="/blog/assets/js/92.d7b5b371.js"><link rel="prefetch" href="/blog/assets/js/93.6d178532.js"><link rel="prefetch" href="/blog/assets/js/94.5c319988.js"><link rel="prefetch" href="/blog/assets/js/95.af26136a.js"><link rel="prefetch" href="/blog/assets/js/96.194b001d.js"><link rel="prefetch" href="/blog/assets/js/97.175674ae.js"><link rel="prefetch" href="/blog/assets/js/98.f5682594.js"><link rel="prefetch" href="/blog/assets/js/99.cd78756a.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.1618c296.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.cb6842fd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">戡玉的个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/life/" class="nav-link">
  生活
</a></div><div class="nav-item"><a href="/blog/code/" class="nav-link router-link-active">
  技术
</a></div><div class="nav-item"><a href="/blog/about/" class="nav-link">
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/life/" class="nav-link">
  生活
</a></div><div class="nav-item"><a href="/blog/code/" class="nav-link router-link-active">
  技术
</a></div><div class="nav-item"><a href="/blog/about/" class="nav-link">
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>文章</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>web前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>javascript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/code/article/javascript/1.html" class="sidebar-link">jQuery 的原生替代</a></li><li><a href="/blog/code/article/javascript/2.html" class="sidebar-link">javascript domAPI 整理</a></li><li><a href="/blog/code/article/javascript/3.html" class="sidebar-link">javascript 获取坐标/滚动/宽高/距离</a></li><li><a href="/blog/code/article/javascript/4.html" class="sidebar-link">javascript 运行时中的堆栈和队列</a></li><li><a href="/blog/code/article/javascript/5.html" class="sidebar-link">javascript 内存管理</a></li><li><a href="/blog/code/article/javascript/6.html" class="sidebar-link">javascript 单线程，异步与执行机制</a></li><li><a href="/blog/code/article/javascript/7.html" class="sidebar-link">javascript 核心基础总结</a></li><li><a href="/blog/code/article/javascript/8.html" class="sidebar-link">javascript 细节知识</a></li><li><a href="/blog/code/article/javascript/9.html" class="sidebar-link">javascript 严格模式</a></li><li><a href="/blog/code/article/javascript/10.html" class="sidebar-link">javascript 代码技巧</a></li><li><a href="/blog/code/article/javascript/11.html" aria-current="page" class="active sidebar-link">javascript 实用代码片段</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#拓展原型" class="sidebar-link">拓展原型</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#实现继承·方法-1" class="sidebar-link">实现继承·方法 1</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#浅拷贝" class="sidebar-link">浅拷贝</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#深拷贝" class="sidebar-link">深拷贝</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#带特性值的浅拷贝" class="sidebar-link">带特性值的浅拷贝</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#mixin-混合" class="sidebar-link">mixin 混合</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#对象拓展" class="sidebar-link">对象拓展</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#函数柯里化-currying" class="sidebar-link">函数柯里化(Currying)</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#函数节流" class="sidebar-link">函数节流</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#函数防抖" class="sidebar-link">函数防抖</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#跨文件共享私有对象-模块互访" class="sidebar-link">跨文件共享私有对象(模块互访)</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#类型判断" class="sidebar-link">类型判断</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#软绑定-默认绑定可设置" class="sidebar-link">软绑定[默认绑定可设置]</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#将时间戳转换成时间描述" class="sidebar-link">将时间戳转换成时间描述</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#tofixed-精度修复" class="sidebar-link">toFixed 精度修复</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#js-精度运算" class="sidebar-link">js 精度运算</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#js-滚轮绑定" class="sidebar-link">js 滚轮绑定</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#js-点击下载" class="sidebar-link">js 点击下载</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#获取区间随机数" class="sidebar-link">获取区间随机数</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#获取梯度随机数" class="sidebar-link">获取梯度随机数</a></li><li class="sidebar-sub-header"><a href="/blog/code/article/javascript/11.html#数据分组" class="sidebar-link">数据分组</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>游览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>计算机基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>源码分析</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总结</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-实用代码片段"><a href="#javascript-实用代码片段" class="header-anchor">#</a> javascript 实用代码片段</h1> <blockquote><p>持续积累中~</p></blockquote> <h2 id="拓展原型"><a href="#拓展原型" class="header-anchor">#</a> 拓展原型</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">method</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> extend</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> extend<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="实现继承·方法-1"><a href="#实现继承·方法-1" class="header-anchor">#</a> 实现继承·方法 1</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 方法1</span>
Function<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token string">&quot;inherits&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Parent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _proptotype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">_proptotype</span><span class="token punctuation">.</span>constructor <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> _proptotype<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 方法2</span>
<span class="token keyword">function</span> <span class="token function">inherits</span><span class="token punctuation">(</span><span class="token parameter">child<span class="token punctuation">,</span> parent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _proptotype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">_proptotype</span><span class="token punctuation">.</span>constructor <span class="token operator">=</span> child<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">;</span>
  child<span class="token punctuation">.</span>prototype <span class="token operator">=</span> _proptotype<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">child</span><span class="token operator">:</span> child<span class="token punctuation">,</span>
    <span class="token literal-property property">parent</span><span class="token operator">:</span> parent<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 方法3-只创建临时构造函数一次</span>
<span class="token keyword">var</span> inherit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">C</span><span class="token punctuation">,</span> <span class="token constant">P</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">P</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
    <span class="token class-name">C</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token constant">C</span><span class="token punctuation">.</span>uber <span class="token operator">=</span> <span class="token class-name">P</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">// 存储超类</span>
    <span class="token class-name">C</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">;</span> <span class="token comment">// 重置构造函数指针</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="浅拷贝"><a href="#浅拷贝" class="header-anchor">#</a> 浅拷贝</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">simpleCopy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="深拷贝"><a href="#深拷贝" class="header-anchor">#</a> 深拷贝</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> parent <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//parent用于递归循环引用爆栈处理</span>
  <span class="token comment">// 创建一个新对象</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">obj<span class="token punctuation">.</span>constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//保持继承链</span>
  <span class="token keyword">let</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">,</span>
    key <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    temp <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    _parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
  <span class="token comment">// 该字段若有父级则需要追溯该字段的父级</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>_parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果该字段引用了它的父级则为循环引用</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_parent<span class="token punctuation">.</span>originalParent <span class="token operator">===</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> _parent<span class="token punctuation">.</span>currentParent<span class="token punctuation">;</span> <span class="token comment">// 循环引用直接返回同级的新对象</span>
    <span class="token punctuation">}</span>
    _parent <span class="token operator">=</span> _parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    key <span class="token operator">=</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    temp <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">&amp;&amp;</span> <span class="token function">isType</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">&amp;&amp;</span> <span class="token function">isType</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;regExp&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 若字段的值是一个对象/数组</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">isType</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">||</span> <span class="token function">isType</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;array&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 递归执行深拷贝 将同级的待拷贝对象与新对象传递给 parent 方便追溯循环引用</span>
      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">originalParent</span><span class="token operator">:</span> obj<span class="token punctuation">,</span>
        <span class="token literal-property property">currentParent</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
        <span class="token literal-property property">parent</span><span class="token operator">:</span> parent<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="带特性值的浅拷贝"><a href="#带特性值的浅拷贝" class="header-anchor">#</a> 带特性值的浅拷贝</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Composition</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> source</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> desc <span class="token operator">=</span> Object<span class="token punctuation">.</span>getOwnPropertyDescriptor<span class="token punctuation">;</span>
    <span class="token keyword">var</span> prop <span class="token operator">=</span> Object<span class="token punctuation">.</span>getOwnPropertyNames<span class="token punctuation">;</span>
    <span class="token keyword">var</span> def_prop<span class="token operator">=</span>Object<span class="token punctuation">.</span>defineProperty<span class="token punctuation">;</span>
    <span class="token function">prop</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">def_prop</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key， <span class="token function">desc</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> target<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="mixin-混合"><a href="#mixin-混合" class="header-anchor">#</a> mixin 混合</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mix</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> arg<span class="token punctuation">,</span>
    prop<span class="token punctuation">,</span>
    child <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>arg <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> arg <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> arg <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> arguments<span class="token punctuation">[</span>arg<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span>arg<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        child<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>arg<span class="token punctuation">]</span><span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> child<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="对象拓展"><a href="#对象拓展" class="header-anchor">#</a> 对象拓展</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">MYAPP</span> <span class="token operator">=</span> <span class="token constant">MYAPP</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token constant">MYAPP</span><span class="token punctuation">.</span><span class="token function-variable function">namespace</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ns_string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> parts <span class="token operator">=</span> ns_string<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    parent <span class="token operator">=</span> <span class="token constant">MYAPP</span><span class="token punctuation">,</span>
    i<span class="token punctuation">;</span>
  <span class="token comment">//忽略第一个</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;MYAPP&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    parts <span class="token operator">=</span> parts<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> parts<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//如果属性不存在，就创建</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> parent<span class="token punctuation">[</span>parts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      parent<span class="token punctuation">[</span>parts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    parent <span class="token operator">=</span> parent<span class="token punctuation">[</span>parts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> parent<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token constant">MYAPP</span><span class="token punctuation">.</span><span class="token function">namespace</span><span class="token punctuation">(</span><span class="token string">&quot;once.upon.a.time.there.was.this.long.nested.property&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="函数柯里化-currying"><a href="#函数柯里化-currying" class="header-anchor">#</a> 函数柯里化(Currying)</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> innerArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> finalArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>innerArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> finalArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> curriedAdd <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">curriedAdd</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//8</span>
</code></pre></div><h2 id="函数节流"><a href="#函数节流" class="header-anchor">#</a> 函数节流</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timer<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="函数防抖"><a href="#函数防抖" class="header-anchor">#</a> 函数防抖</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="跨文件共享私有对象-模块互访"><a href="#跨文件共享私有对象-模块互访" class="header-anchor">#</a> 跨文件共享私有对象(模块互访)</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> blogModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">my</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _private <span class="token operator">=</span> <span class="token punctuation">(</span>my<span class="token punctuation">.</span>_private <span class="token operator">=</span> my<span class="token punctuation">.</span>_private <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    _seal <span class="token operator">=</span> <span class="token punctuation">(</span>my<span class="token punctuation">.</span>_seal <span class="token operator">=</span>
      my<span class="token punctuation">.</span>_seal <span class="token operator">||</span>
      <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">delete</span> my<span class="token punctuation">.</span>_private<span class="token punctuation">;</span>
        <span class="token keyword">delete</span> my<span class="token punctuation">.</span>_seal<span class="token punctuation">;</span>
        <span class="token keyword">delete</span> my<span class="token punctuation">.</span>_unseal<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    _unseal <span class="token operator">=</span> <span class="token punctuation">(</span>my<span class="token punctuation">.</span>_unseal <span class="token operator">=</span>
      my<span class="token punctuation">.</span>_unseal <span class="token operator">||</span>
      <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        my<span class="token punctuation">.</span>_private <span class="token operator">=</span> _private<span class="token punctuation">;</span>
        my<span class="token punctuation">.</span>_seal <span class="token operator">=</span> _seal<span class="token punctuation">;</span>
        my<span class="token punctuation">.</span>_unseal <span class="token operator">=</span> _unseal<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> my<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>obj <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="类型判断"><a href="#类型判断" class="header-anchor">#</a> 类型判断</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">isType</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// tostring会返回对应不同的标签的构造函数</span>
  <span class="token keyword">const</span> toString <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>
  <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;[object Boolean]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;boolean&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object Number]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object String]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object Function]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object Array]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;array&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object Date]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object RegExp]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regExp&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object Object]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object Undefined]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object Null]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;null&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;[object Error]&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> type <span class="token operator">?</span> type <span class="token operator">===</span> <span class="token string">&quot;element&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;element&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> type <span class="token operator">?</span> type <span class="token operator">===</span> map<span class="token punctuation">[</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">:</span> map<span class="token punctuation">[</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="软绑定-默认绑定可设置"><a href="#软绑定-默认绑定可设置" class="header-anchor">#</a> 软绑定[默认绑定可设置]</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">softBind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">// 捕获所有 curried 参数</span>
    <span class="token keyword">var</span> curried <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> arguments<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">bound</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span> <span class="token operator">||</span> <span class="token keyword">this</span> <span class="token operator">===</span> <span class="token punctuation">(</span>window <span class="token operator">||</span> global<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span>
                    <span class="token literal-property property">obj</span> <span class="token operator">:</span> <span class="token keyword">this</span>
            curried<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span> curried<span class="token punctuation">,</span> arguments <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    bound<span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> fn<span class="token punctuation">.</span>prototype <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> bound<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="将时间戳转换成时间描述"><a href="#将时间戳转换成时间描述" class="header-anchor">#</a> 将时间戳转换成时间描述</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getTimeDesc</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _n <span class="token operator">=</span> <span class="token number">12</span> <span class="token operator">*</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    _y <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    _d <span class="token operator">=</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    _h <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    _m <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    _s <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    n<span class="token punctuation">,</span>
    y<span class="token punctuation">,</span>
    d<span class="token punctuation">,</span>
    h<span class="token punctuation">,</span>
    m<span class="token punctuation">,</span>
    s<span class="token punctuation">,</span>
    value<span class="token punctuation">;</span>

  n <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">&gt;</span> _n <span class="token operator">?</span> time <span class="token operator">/</span> _n <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  n <span class="token operator">=</span> n <span class="token operator">?</span> n <span class="token operator">+</span> <span class="token string">&quot;年&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  time <span class="token operator">=</span> time <span class="token operator">%</span> _n<span class="token punctuation">;</span>

  y <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">&gt;</span> _y <span class="token operator">?</span> time <span class="token operator">/</span> _y <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  y <span class="token operator">=</span> y <span class="token operator">?</span> y <span class="token operator">+</span> <span class="token string">&quot;月&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  time <span class="token operator">=</span> time <span class="token operator">%</span> _y<span class="token punctuation">;</span>

  d <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">&gt;</span> _d <span class="token operator">?</span> time <span class="token operator">/</span> _d <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  d <span class="token operator">=</span> d <span class="token operator">?</span> d <span class="token operator">+</span> <span class="token string">&quot;天&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  time <span class="token operator">=</span> time <span class="token operator">%</span> _d<span class="token punctuation">;</span>

  h <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">&gt;</span> _h <span class="token operator">?</span> time <span class="token operator">/</span> _h <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  h <span class="token operator">=</span> h <span class="token operator">?</span> h <span class="token operator">+</span> <span class="token string">&quot;时&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  time <span class="token operator">=</span> time <span class="token operator">%</span> _h<span class="token punctuation">;</span>

  m <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">&gt;</span> _m <span class="token operator">?</span> time <span class="token operator">/</span> _m <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  m <span class="token operator">=</span> m <span class="token operator">?</span> m <span class="token operator">+</span> <span class="token string">&quot;分&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  time <span class="token operator">=</span> time <span class="token operator">%</span> _m<span class="token punctuation">;</span>

  s <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">&gt;</span> _s <span class="token operator">?</span> time <span class="token operator">/</span> _s <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  s <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token string">&quot;秒&quot;</span><span class="token punctuation">;</span>

  value <span class="token operator">=</span> n <span class="token operator">+</span> y <span class="token operator">+</span> d <span class="token operator">+</span> h <span class="token operator">+</span> m <span class="token operator">+</span> s<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="tofixed-精度修复"><a href="#tofixed-精度修复" class="header-anchor">#</a> toFixed 精度修复</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Number</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toFixed</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token number">20</span> <span class="token operator">||</span> n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RangeError</span><span class="token punctuation">(</span><span class="token string">&quot;toFixed() digits argument must be between 0 and 20&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> number <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">||</span> number <span class="token operator">&gt;=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> number<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> n <span class="token operator">==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> result <span class="token operator">=</span> number<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 整数的情况</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">+=</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">+=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> integer <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> decimal <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>decimal<span class="token punctuation">.</span>length <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>decimal<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> decimal<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">+=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  result <span class="token operator">=</span> integer <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> decimal<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> last <span class="token operator">=</span> decimal<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 四舍五入，转换为整数再处理，避免浮点数精度的损失</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>last<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">parseFloat</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> x<span class="token punctuation">;</span>
    result <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="js-精度运算"><a href="#js-精度运算" class="header-anchor">#</a> js 精度运算</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> floatObj <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 判断obj是否为一个整数</span>
  <span class="token keyword">function</span> <span class="token function">isInteger</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/*
   * 将一个浮点数转成整数，返回整数和倍数。如 3.14 &gt;&gt; 314，倍数是 100
   * @param floatNum {number} 小数
   * @return {object}
   *   {times:100, num: 314}
   */</span>
  <span class="token keyword">function</span> <span class="token function">toInteger</span><span class="token punctuation">(</span><span class="token parameter">floatNum</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">times</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">num</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> isNegative <span class="token operator">=</span> floatNum <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isInteger</span><span class="token punctuation">(</span>floatNum<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ret<span class="token punctuation">.</span>num <span class="token operator">=</span> floatNum<span class="token punctuation">;</span>
      <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> strfi <span class="token operator">=</span> floatNum <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> dotPos <span class="token operator">=</span> strfi<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> len <span class="token operator">=</span> strfi<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>dotPos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">var</span> times <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> intNum <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>floatNum<span class="token punctuation">)</span> <span class="token operator">*</span> times <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ret<span class="token punctuation">.</span>times <span class="token operator">=</span> times<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isNegative<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      intNum <span class="token operator">=</span> <span class="token operator">-</span>intNum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ret<span class="token punctuation">.</span>num <span class="token operator">=</span> intNum<span class="token punctuation">;</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/*
   * 核心方法，实现加减乘除运算，确保不丢失精度
   * 思路：把小数放大为整数（乘），进行算术运算，再缩小为小数（除）
   *
   * @param a {number} 运算数1
   * @param b {number} 运算数2
   * @param digits {number} 精度，保留的小数点数，比如 2, 即保留为两位小数
   * @param op {string} 运算类型，有加减乘除（add/subtract/multiply/divide）
   *
   */</span>
  <span class="token keyword">function</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits<span class="token punctuation">,</span> op</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> o1 <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> o2 <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> n1 <span class="token operator">=</span> o1<span class="token punctuation">.</span>num<span class="token punctuation">;</span>
    <span class="token keyword">var</span> n2 <span class="token operator">=</span> o2<span class="token punctuation">.</span>num<span class="token punctuation">;</span>
    <span class="token keyword">var</span> t1 <span class="token operator">=</span> o1<span class="token punctuation">.</span>times<span class="token punctuation">;</span>
    <span class="token keyword">var</span> t2 <span class="token operator">=</span> o2<span class="token punctuation">.</span>times<span class="token punctuation">;</span>
    <span class="token keyword">var</span> max <span class="token operator">=</span> t1 <span class="token operator">&gt;</span> t2 <span class="token operator">?</span> t1 <span class="token operator">:</span> t2<span class="token punctuation">;</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>op<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">&quot;add&quot;</span><span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>t1 <span class="token operator">===</span> t2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 两个小数位数相同</span>
          result <span class="token operator">=</span> n1 <span class="token operator">+</span> n2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>t1 <span class="token operator">&gt;</span> t2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// o1 小数位 大于 o2</span>
          result <span class="token operator">=</span> n1 <span class="token operator">+</span> n2 <span class="token operator">*</span> <span class="token punctuation">(</span>t1 <span class="token operator">/</span> t2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// o1 小数位 小于 o2</span>
          result <span class="token operator">=</span> n1 <span class="token operator">*</span> <span class="token punctuation">(</span>t2 <span class="token operator">/</span> t1<span class="token punctuation">)</span> <span class="token operator">+</span> n2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>result <span class="token operator">/</span> max<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>digits<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;subtract&quot;</span><span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>t1 <span class="token operator">===</span> t2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          result <span class="token operator">=</span> n1 <span class="token operator">-</span> n2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>t1 <span class="token operator">&gt;</span> t2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          result <span class="token operator">=</span> n1 <span class="token operator">-</span> n2 <span class="token operator">*</span> <span class="token punctuation">(</span>t1 <span class="token operator">/</span> t2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          result <span class="token operator">=</span> n1 <span class="token operator">*</span> <span class="token punctuation">(</span>t2 <span class="token operator">/</span> t1<span class="token punctuation">)</span> <span class="token operator">-</span> n2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>result <span class="token operator">/</span> max<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>digits<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;multiply&quot;</span><span class="token operator">:</span>
        result <span class="token operator">=</span> <span class="token punctuation">(</span>n1 <span class="token operator">*</span> n2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>t1 <span class="token operator">*</span> t2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>digits<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;divide&quot;</span><span class="token operator">:</span>
        result <span class="token operator">=</span> <span class="token punctuation">(</span>n1 <span class="token operator">/</span> n2<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>t2 <span class="token operator">/</span> t1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>digits<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 加</span>
  <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token function">operation</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits<span class="token punctuation">,</span> <span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> value <span class="token operator">==</span> <span class="token number">NaN</span> <span class="token operator">||</span> value <span class="token operator">==</span> <span class="token number">Infinity</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 减</span>
  <span class="token keyword">function</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token function">operation</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits<span class="token punctuation">,</span> <span class="token string">&quot;subtract&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> value <span class="token operator">==</span> <span class="token number">NaN</span> <span class="token operator">||</span> value <span class="token operator">==</span> <span class="token number">Infinity</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 乘</span>
  <span class="token keyword">function</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token function">operation</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits<span class="token punctuation">,</span> <span class="token string">&quot;multiply&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> value <span class="token operator">==</span> <span class="token number">NaN</span> <span class="token operator">||</span> value <span class="token operator">==</span> <span class="token number">Infinity</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 除</span>
  <span class="token keyword">function</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token function">operation</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> digits<span class="token punctuation">,</span> <span class="token string">&quot;divide&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> value <span class="token operator">==</span> <span class="token number">NaN</span> <span class="token operator">||</span> value <span class="token operator">==</span> <span class="token number">Infinity</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> add<span class="token punctuation">,</span> subtract<span class="token punctuation">,</span> multiply<span class="token punctuation">,</span> divide <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="js-滚轮绑定"><a href="#js-滚轮绑定" class="header-anchor">#</a> js 滚轮绑定</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">EventTarget</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">onMousewheel</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> capture</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>mozFullScreen <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    type <span class="token operator">=</span> <span class="token string">&quot;DOMMouseScroll&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    type <span class="token operator">=</span> <span class="token string">&quot;mousewheel&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
    type<span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      event<span class="token punctuation">.</span>delta <span class="token operator">=</span> event<span class="token punctuation">.</span>wheelDelta
        <span class="token operator">?</span> event<span class="token punctuation">.</span>wheelDelta <span class="token operator">/</span> <span class="token number">120</span>
        <span class="token operator">:</span> <span class="token operator">-</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>detail <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    capture <span class="token operator">||</span> <span class="token boolean">false</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="js-点击下载"><a href="#js-点击下载" class="header-anchor">#</a> js 点击下载</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">browserDownload</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> save_link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElementNS</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  save_link<span class="token punctuation">.</span>href <span class="token operator">=</span> url<span class="token punctuation">;</span>
  save_link<span class="token punctuation">.</span>download <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">var</span> ev <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">&quot;MouseEvents&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ev<span class="token punctuation">.</span><span class="token function">initMouseEvent</span><span class="token punctuation">(</span>
    <span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span>
    <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    window<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  save_link<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="获取区间随机数"><a href="#获取区间随机数" class="header-anchor">#</a> 获取区间随机数</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">random</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> random <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>m <span class="token operator">-</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> random<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="获取梯度随机数"><a href="#获取梯度随机数" class="header-anchor">#</a> 获取梯度随机数</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">step_random</span><span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span> max<span class="token punctuation">,</span> step</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> newMax <span class="token operator">=</span> max <span class="token operator">/</span> step<span class="token punctuation">;</span>
  <span class="token keyword">var</span> randomNum <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>newMax <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> stepNum <span class="token operator">=</span> randomNum <span class="token operator">*</span> step<span class="token punctuation">;</span>
  <span class="token keyword">return</span> stepNum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="数据分组"><a href="#数据分组" class="header-anchor">#</a> 数据分组</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token parameter">array<span class="token punctuation">,</span> valueKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> newArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  array<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    groups<span class="token punctuation">[</span>valueKey<span class="token punctuation">]</span> <span class="token operator">=</span> groups<span class="token punctuation">[</span>group<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    groups<span class="token punctuation">[</span>valueKey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> groups<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    newArray <span class="token operator">=</span> newArray<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>groups<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> newArray<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/code/article/javascript/10.html" class="prev">
        javascript 代码技巧
      </a></span> <span class="next"><a href="/blog/code/article/performance/1.html">
        vue 巨量表单型内容表格优化实践
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.000460b6.js" defer></script><script src="/blog/assets/js/2.d291a91f.js" defer></script><script src="/blog/assets/js/1.eb9a41bf.js" defer></script><script src="/blog/assets/js/36.c76dcab4.js" defer></script>
  </body>
</html>
